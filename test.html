<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fetch WP Posts by Category</title>
</head>

<body>
    <h1>Fetch Posts by Category</h1>
    <a href="#" id="fetch-posts" data-category-slug="bikes">Get Posts in Category</a>
    <ul id="posts-list"></ul>

    <script>
        // URL of your WordPress site
        const siteUrl = "https://stianrostad.no/wordpress";

        // Fetch posts by category slug when the link is clicked
        document.getElementById('fetch-posts').addEventListener('click', async function (event) {
            event.preventDefault(); // Prevent default link behavior

            const categorySlug = this.getAttribute('data-category-slug'); // Get the category slug from the data attribute
            const apiUrl = `${siteUrl}/wp-json/wp/v2/posts?categories_slug=${categorySlug}`;
            const postsList = document.getElementById('posts-list');
            postsList.innerHTML = ''; // Clear previous posts

            try {
                // Fetch the posts
                const response = await fetch(apiUrl);

                // Check for HTTP errors
                if (!response.ok) {
                    throw new Error(`HTTP Error: ${response.status} - ${response.statusText}`);
                }

                // Parse the response
                const posts = await response.json();

                // Display the posts in a list
                if (posts.length > 0) {
                    posts.forEach(post => {
                        const listItem = document.createElement('li');
                        listItem.innerHTML = `<a href="${post.link}" target="_blank">${post.title.rendered}</a>`;
                        postsList.appendChild(listItem);
                    });
                } else {
                    postsList.innerHTML = '<li>No posts found in this category.</li>';
                }
            } catch (error) {
                // Handle errors
                console.error('Error fetching posts:', error);
                postsList.innerHTML = `<li>Error fetching posts: ${error.message}</li>`;
            }
        });
    </script>
</body>

</html>